This code is the code described on FFC, which I will further develop.
